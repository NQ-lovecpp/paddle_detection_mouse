# äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ çš„åŸºæœ¬ç†å¿µ

1. äººå·¥æ™ºèƒ½>æœºå™¨å­¦ä¹ >æ·±åº¦å­¦ä¹ 
	```mermaid
	graph TD
	subgraph äººå·¥æ™ºèƒ½
		subgraph æœºå™¨å­¦ä¹ 
		  æ·±åº¦å­¦ä¹ [æ·±åº¦å­¦ä¹ ]
		end
	  end
	```
2. **äººå·¥æ™ºèƒ½**ï¼šç ”ç©¶ã€å¼€å‘ç”¨äºæ¨¡æ‹Ÿã€å»¶ä¼¸å’Œæ‰©å±•äººçš„æ™ºèƒ½çš„ç†è®ºã€æ–¹æ³•ã€æŠ€æœ¯åŠåº”ç”¨ç³»ç»Ÿçš„ä¸€é—¨æ–°çš„æŠ€æœ¯ç§‘å­¦
3. äººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ï¼Œæœºå™¨å­¦ä¹ ï¼ˆç›‘ç£å­¦ä¹ ï¼‰åˆ™æœ‰æ›´åŠ æ˜ç¡®çš„æŒ‡ä»£
4. **æœºå™¨å­¦ä¹ **ï¼šä¸“é—¨ç ”ç©¶è®¡ç®—æœºæ€æ ·æ¨¡æ‹Ÿæˆ–å®ç°äººç±»çš„å­¦ä¹ è¡Œä¸ºï¼Œä»¥è·å–æ–°çš„çŸ¥è¯†æˆ–æŠ€èƒ½ï¼Œé‡æ–°ç»„ç»‡å·²æœ‰çš„çŸ¥è¯†ç»“æ„ä½¿ä¹‹ä¸æ–­æ”¹å–„è‡ªèº«çš„æ€§èƒ½
5. ä¸‹é¢è¿™å¥è¯å…·ä½“æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ
>Difference between machine learning and Al:
>- If it is written in Python, it's probably machine learning 
>- If it is written in PowerPoint, it's probably Al

---

æœºå™¨å­¦ä¹ ï¼Œä»¥ç›‘ç£å­¦ä¹ ä¸ºä¾‹ï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼š
- è®­ç»ƒï¼ˆå½’çº³ï¼‰ï¼šå·²çŸ¥ä¸€å®šæ•°é‡çš„ï¼ˆxï¼Œyï¼‰ï¼Œå­¦ä¹ å‡ºY~Xçš„å…³ç³»
- é¢„æµ‹æˆ–æ¨ç†ï¼ˆæ¼”ç»ï¼‰ï¼šé¢å¯¹æ–°å‡ºç°çš„Xï¼Œé¢„æµ‹Y

>è®­ç»ƒå’Œæ¨ç†æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸçš„ç”¨è¯­ï¼Œè€Œå½’çº³å’Œæ¼”ç»æ˜¯æ•°å­¦é¢†åŸŸçš„ç”¨è¯­ï¼Œä¸¤è€…æœ‰ç›¸ä¼¼ä¹‹å¤„



---
# ç†è§£æœºå™¨å®ç°å­¦ä¹ çš„æ‰§è¡Œæ¡†æ¶ï¼Œå­¦ä¹ çš„æœ¬è´¨æ˜¯â€œå‚æ•°ä¼°è®¡â€

>æœºå™¨å­¦ä¹ å°±æ˜¯æ‹Ÿåˆä¸€ä¸ªâ€œå¤§å…¬å¼â€

- **ç‰›é¡¿ç¬¬äºŒå®šå¾‹**
  $$
  f(\text{F}) = 2.5 \quad \text{ï¼ˆF=5ï¼‰}
  $$

- **å›¾åƒè¯†åˆ«**
  $$
  f(\text{å›¾ç‰‡}) = \text{â€œç¾å¥³â€}
  $$

- **æœºå™¨ç¿»è¯‘**
  $$
  f(\text{â€œRain cats and dogsâ€}) = \text{â€œå€¾ç›†å¤§é›¨â€}
  $$

- **è‡ªåŠ¨é—®ç­”**
  $$
  f(\text{â€œå§šæ˜æ˜¯å“ªé‡Œäººï¼Ÿâ€}) = \text{â€œä¸Šæµ·â€}
  $$
---

>å­¦ä¹ çš„è¿‡ç¨‹ä¸æå‡ºç°å‡è¯´çš„æ–¹å¼ç±»ä¼¼ï¼Œåˆç†çš„å‡è¯´è‡³å°‘èƒ½å¤Ÿè§£é‡Šå·²æœ‰è§‚æµ‹
>Learning is parameter estimationï¼Œå­¦ä¹ æ— éå°±æ˜¯å‚æ•°ä¼°è®¡

![[Pasted image 20240715102119.png]]

>[!Tip] æœºå™¨å­¦ä¹ ç®—æ³•æ„æˆçš„ä¸‰è¦ç´ 
>
>1. **å‡è®¾ç©ºé—´ï¼š** æ¨¡å‹çš„å‡è®¾æˆ–è¡¨ç¤º
>2. **ä¼˜åŒ–ç›®æ ‡ï¼š** è¯„ä»·æˆ–æŸå¤±å‡½æ•°ï¼ˆLossï¼‰
>3. **å¯»æ‰¾ç®—æ³•ï¼š** ä¼˜åŒ–/æ±‚è§£ç®—æ³•

---

# å…³äºæ·±åº¦å­¦ä¹ 

>æ·±åº¦å­¦ä¹ æ˜¯ä»€ä¹ˆï¼Ÿ

æ·±åº¦å­¦ä¹ æ˜¯å­¦ä¹ æ ·æœ¬æ•°æ®çš„å†…åœ¨è§„å¾‹å’Œè¡¨ç¤ºå±‚æ¬¡ï¼Œè¿™äº›å­¦ä¹ è¿‡ç¨‹ä¸­è·å¾—çš„ä¿¡æ¯å¯¹è¯¸å¦‚æ–‡å­—ï¼Œå›¾åƒå’Œå£°éŸ³ç­‰æ•°æ®çš„è§£é‡Šæœ‰å¾ˆå¤§çš„å¸®åŠ©


>æ·±åº¦å­¦ä¹ çš„é€šä¿—ç†è§£

- ç°å®ä¸­å¤§é‡å…³ç³»çš„å¤æ‚åº¦è¦è¿œè¿œè¶…å‡ºç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼Œç®€å•çš„å‡è®¾éš¾ä»¥è¡¨è¾¾
- ä»äººè„‘ç»“æ„è·å¾—å¯å‘ï¼Œè®¾è®¡å‡ºä¸€ç§å‡ ä¹å¯ä»¥æ‹Ÿåˆä»»ä½•å…³ç³»çš„å¼ºå¤§å…¬å¼![[Pasted image 20240715103609.png]]

>æ·±åº¦å­¦ä¹ çš„é€‚ç”¨é¢†åŸŸ

- æ–‡å­—ï¼ˆNatural Language Processï¼‰
- å›¾åƒï¼ˆComputer Visionï¼‰
- è¯­éŸ³ï¼ˆSpeech Recognitionï¼‰

ä»¥ä¸Šè¿™äº›éƒ½æ˜¯äººå·¥æ™ºèƒ½çš„åŸºç¡€æ¨¡å—

---
# ä½¿ç”¨Python+Numpyæ­å»ºç¥ç»ç½‘ç»œæ¨¡å‹å®Œæˆæˆ¿ä»·é¢„æµ‹ä»»åŠ¡

ã€æ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹ã€‘æ˜¯æœ€å…¸å‹ã€æœ€å®¹æ˜“ç†è§£çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼š13ä¸ªXé¢„æµ‹ä¸€ä¸ªY

| ![[Pastedimage20240715105907.png]] | ![[Pasted image 20240715110711.png]] |
|---|---|

>æˆ¿ä»·é¢„æµ‹æ¨¡å‹ï¼Œæ˜¯å…¸å‹çš„çº¿æ€§å›å½’æ¨¡å‹

é¢„æµ‹é—®é¢˜åˆ†å¯ä¸ºä¸¤ç±»ï¼š
1. å›å½’é—®é¢˜ï¼šè¾“å‡ºä¸ºè¿ç»­å€¼ï¼ˆä¸€ä¸ªå®æ•°ï¼‰ï¼Œæ¯”å¦‚èº«é«˜
2. åˆ†ç±»é—®é¢˜ï¼šè¾“å‡ºä¸ºç¦»æ•£å€¼ï¼Œæ¯”å¦‚æ€§åˆ«

è¿™é‡Œçš„æˆ¿ä»·é¢„æµ‹æ˜¯å›å½’é—®é¢˜ï¼Œå…·ä½“æ¥è¯´æ˜¯**å¤šå…ƒçº¿æ€§å›å½’**ï¼Œéœ€è¦æŒ‰ç…§ä¸Šé¢æåˆ°çš„â€œæœºå™¨å­¦ä¹ ç®—æ³•ä¸‰è¦ç´ â€è¿›è¡Œåˆ†æï¼š

## é—®é¢˜è§£æ
### ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨çº¿æ€§å‡è®¾

è®¤ä¸ºå¤šä¸ªå½±å“æˆ¿ä»·çš„å› ç´ å’Œæˆ¿ä»·ä¹‹é—´æ˜¯çº¿æ€§å…³ç³»ï¼Œå¯ä»¥ç”¨çº¿æ€§æ–¹ç¨‹è¡¨ç¤ºï¼š
$$
y_i = \omega_1 x_{i_1} + \omega_2 x_{i_2} + \cdots + \omega_{d} X_{i_d} + b, \quad i = 1, \ldots, n
$$

### ç¬¬äºŒæ­¥ï¼šä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºæŸå¤±å‡½æ•°

è¡¡é‡é¢„æµ‹æˆ¿ä»·å’ŒçœŸå®æˆ¿ä»·çš„å·®å¼‚ï¼š
$$
\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (Y_i - \hat{Y_i})^2
$$

>[!Question] æ€è€ƒï¼š**ä¸ºä»€ä¹ˆæŸå¤±å‡½æ•°æ˜¯å¹³æ–¹å’Œï¼Ÿ**
>å› ä¸ºç›´æ¥æ±‚å’Œå–å¹³å‡ï¼Œä¸èƒ½åæ˜ æ¨ç†æ•°æ®å’ŒçœŸå®æ•°æ®çš„å·®è·ï¼Œå¹³æ–¹èƒ½ä¿è¯æ¯ç»„å·®è·æ˜¯éè´Ÿçš„

### ç¬¬ä¸‰æ­¥ï¼šæå°åŒ–æŸå¤±å‡½æ•°ï¼ˆè¶Šå‡†è¶Šå¥½ï¼‰

ç¡®å®šå‚æ•° \( w \) å’Œ \( b \) çš„å€¼ã€‚


## æ„å»ºæ¨¡å‹å¹¶è¿›è¡Œè®­ç»ƒ

>æ„å»ºæ¨¡å‹å’Œå®Œæˆè®­ç»ƒçš„ç¨‹åºï¼ŒåŸºæœ¬å¥—è·¯å¦‚ä¸‹

1. æ•°æ®å¤„ç†ï¼šè¯»å–æ•°æ®å’Œé¢„å¤„ç†æ“ä½œ
2. æ¨¡å‹è®¾è®¡ï¼šç½‘ç»œç»“æ„ï¼ˆå‡è®¾ï¼‰
3. è®­ç»ƒé…ç½®ï¼šä¼˜åŒ–å™¨ï¼ˆå¯»è§£ç®—æ³•ï¼‰å’Œè®¡ç®—èµ„æºé…ç½®
4. è®­ç»ƒè¿‡ç¨‹ï¼šå¾ªç¯è°ƒç”¨è®­ç»ƒè¿‡ç¨‹ï¼Œå‰å‘è®¡ç®—+æŸå¤±å‡½æ•°ï¼ˆä¼˜åŒ–ç›®æ ‡ï¼‰+åå‘ä¼ æ’­
5. ä¿å­˜æ¨¡å‹ï¼šå°†è®­ç»ƒå¥½çš„æ¨¡å‹ä¿å­˜

### ç¯å¢ƒé…ç½®
æœ¬æ–‡åŸºäº PaddlePaddle 2.3.2 ç¼–å†™ï¼Œå¦‚æœä½ çš„ç¯å¢ƒä¸æ˜¯æœ¬ç‰ˆæœ¬ï¼Œè¯·å…ˆå‚è€ƒå®˜ç½‘[å®‰è£…](https://www.paddlepaddle.org.cn/install/quick)Â PaddlePaddle 2.3.2ã€‚
```python
import paddle
import numpy as np
import os
import matplotlib
import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns
import warnings
warnings.filterwarnings("ignore")

print(paddle.__version__)
```

```output
2.3.2
```

### ç¬¬ä¸€æ­¥ï¼šæ•°æ®å¤„ç†

æœ¬ç¤ºä¾‹é‡‡ç”¨uci-housingæ•°æ®é›†ï¼Œè¿™æ˜¯ç»å…¸çº¿æ€§å›å½’çš„æ•°æ®é›†ã€‚æ•°æ®é›†å…±7084æ¡æ•°æ®ï¼Œå¯ä»¥æ‹†åˆ†æˆ506è¡Œ,æ¯è¡Œ14åˆ—ã€‚å‰13åˆ—ç”¨æ¥æè¿°æˆ¿å±‹çš„å„ç§ä¿¡æ¯ï¼Œæœ€åä¸€åˆ—ä¸ºè¯¥ç±»æˆ¿å±‹ä»·æ ¼ä¸­ä½æ•°ã€‚

>æ„Ÿå¹å· `!` æ˜¯åœ¨ Jupyter Notebook å’Œä¸€äº›äº¤äº’å¼ Python ç¯å¢ƒä¸­ç”¨æ¥æ‰§è¡Œ shell å‘½ä»¤çš„ã€‚
>`wget` æ˜¯ä¸€ä¸ªç”¨äºä»ç½‘ç»œä¸‹è½½æ–‡ä»¶çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

#### ä¸‹è½½æ•°æ®

```python 
!wget https://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data -O housing.data 
```

#### æ•°æ®è¯»å–

```python 
# ä»æ–‡ä»¶å¯¼å…¥æ•°æ®
datafile = "./housing.data"
housing_data = np.fromfile(datafile, sep=" ")
feature_names = [
    "CRIM",
    "ZN",
    "INDUS",
    "CHAS",
    "NOX",
    "RM",
    "AGE",
    "DIS",
    "RAD",
    "TAX",
    "PTRATIO",
    "B",
    "LSTAT",
    "MEDV",
]
feature_num = len(feature_names)
# å°†åŸå§‹æ•°æ®è¿›è¡ŒReshapeï¼Œå˜æˆ[N, 14]è¿™æ ·çš„å½¢çŠ¶
housing_data = housing_data.reshape(
    [housing_data.shape[0] // feature_num, feature_num]
)
```
![[Pasted image 20240720170433.png]]

#### æ•°æ®é›†åˆ’åˆ†
å°†æ•°æ®é›†åˆ’åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå…¶ä¸­è®­ç»ƒé›†ç”¨äºç¡®å®šæ¨¡å‹çš„å‚æ•°ï¼Œæµ‹è¯•é›†ç”¨äºè¯„åˆ¤æ¨¡å‹çš„æ•ˆæœã€‚

>ä¸ºä»€ä¹ˆè¦å¯¹æ•°æ®é›†è¿›è¡Œæ‹†åˆ†ï¼Œè€Œä¸èƒ½ç›´æ¥åº”ç”¨äºæ¨¡å‹è®­ç»ƒå‘¢ï¼Ÿ

ä¸ºä»€ä¹ˆè¦å¯¹æ•°æ®é›†è¿›è¡Œæ‹†åˆ†ï¼Œè€Œä¸èƒ½ç›´æ¥åº”ç”¨äºæ¨¡å‹è®­ç»ƒå‘¢ï¼Ÿè¿™ä¸å­¦ç”Ÿæ—¶ä»£çš„æˆè¯¾å’Œè€ƒè¯•å…³ç³»æ¯”è¾ƒç±»ä¼¼ï¼Œå¦‚å›¾æ‰€ç¤º
![[Pasted image 20240720170738.png]]

ä¸Šå­¦æ—¶æ€»æœ‰ä¸€äº›è‡ªä½œèªæ˜çš„åŒå­¦ï¼Œå¹³æ—¶ä¸è®¤çœŸå­¦ä¹ ï¼Œè€ƒè¯•å‰ä¸´é˜µæŠ±ä½›è„šï¼Œå°†ä¹ é¢˜æ­»è®°ç¡¬èƒŒä¸‹æ¥ï¼Œä½†æ˜¯æˆç»©å¾€å¾€å¹¶ä¸å¥½ã€‚å› ä¸ºå­¦æ ¡æœŸæœ›å­¦ç”ŸæŒæ¡çš„æ˜¯çŸ¥è¯†ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¹ é¢˜æœ¬èº«ã€‚å¦å‡ºæ–°çš„è€ƒé¢˜ï¼Œæ‰èƒ½é¼“åŠ±å­¦ç”ŸåŠªåŠ›å»æŒæ¡ä¹ é¢˜èƒŒåçš„åŸç†ã€‚åŒæ ·æˆ‘ä»¬æœŸæœ›æ¨¡å‹å­¦ä¹ çš„æ˜¯ä»»åŠ¡çš„æœ¬è´¨è§„å¾‹ï¼Œè€Œä¸æ˜¯è®­ç»ƒæ•°æ®æœ¬èº«ï¼Œæ¨¡å‹è®­ç»ƒæœªä½¿ç”¨çš„æ•°æ®ï¼Œæ‰èƒ½æ›´çœŸå®çš„è¯„ä¼°æ¨¡å‹çš„æ•ˆæœã€‚

åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†80%çš„æ•°æ®ç”¨ä½œè®­ç»ƒé›†ï¼Œ20%ç”¨ä½œæµ‹è¯•é›†ï¼Œå®ç°ä»£ç å¦‚ä¸‹ã€‚é€šè¿‡æ‰“å°è®­ç»ƒé›†çš„å½¢çŠ¶ï¼Œå¯ä»¥å‘ç°å…±æœ‰404ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬å«æœ‰13ä¸ªç‰¹å¾å’Œ1ä¸ªé¢„æµ‹å€¼ã€‚
```python
ratio = 0.8
offset = int(data.shape[0] * ratio)
training_data = data[:offset]
 
print(data.shape)
print(training_data.shape)
```
![[Pasted image 20240720171236.png]]


#### æ•°æ®å½’ä¸€åŒ–å¤„ç†

å¯¹æ¯ä¸ªç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸ªç‰¹å¾çš„å–å€¼ç¼©æ”¾åˆ°0~1ä¹‹é—´ã€‚

å¯¹ç‰¹å¾å–å€¼èŒƒå›´è¿›è¡Œå½’ä¸€åŒ–ï¼Œæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š
1. æ¨¡å‹è®­ç»ƒæ›´é«˜æ•ˆ
2. ç‰¹å¾å‰çš„æƒé‡å¤§å°å¯ä»¥ä»£è¡¨è¯¥å˜é‡å¯¹é¢„æµ‹ç»“æœçš„è´¡çŒ®åº¦ï¼ˆå› ä¸ºæ¯ä¸ªç‰¹å¾å€¼æœ¬èº«çš„èŒƒå›´ç›¸åŒï¼‰ã€‚

```python
# è®¡ç®—trainæ•°æ®é›†çš„æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå¹³å‡å€¼
maximums, minimums, avgs =\
    training_data.max(axis=0),\
    training_data.min(axis=0), \
    training_data.sum(axis=0) / training_data.shape[0]
```

   - `training_data.max(axis=0)`ï¼šè®¡ç®—æ¯åˆ—çš„æœ€å¤§å€¼ã€‚`axis=0` è¡¨ç¤ºæŒ‰åˆ—æ“ä½œã€‚å¦‚æœ `training_data` æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œè¿™ä¼šè¿”å›ä¸€ä¸ªåŒ…å«æ¯åˆ—æœ€å¤§å€¼çš„ä¸€ç»´æ•°ç»„ã€‚
   - `training_data.min(axis=0)`ï¼šè®¡ç®—æ¯åˆ—çš„æœ€å°å€¼ã€‚`axis=0` è¡¨ç¤ºæŒ‰åˆ—æ“ä½œã€‚å¦‚æœ `training_data` æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œè¿™ä¼šè¿”å›ä¸€ä¸ªåŒ…å«æ¯åˆ—æœ€å°å€¼çš„ä¸€ç»´æ•°ç»„ã€‚
   - `training_data.sum(axis=0) / training_data.shape[0]`ï¼šè®¡ç®—æ¯åˆ—çš„å’Œï¼Œç„¶åé™¤ä»¥è¡Œæ•°ï¼Œå¾—åˆ°æ¯åˆ—çš„å¹³å‡å€¼ã€‚`training_data.shape[0]` è¿”å›æ•°æ®é›†çš„è¡Œæ•°ã€‚

>å½’ä¸€åŒ–å¤„ç†

   ```python
   for i in range(feature_num):
       # print(maximums[i], minimums[i], avgs[i])
       data[:, i] = (data[:, i] - avgs[i]) / (maximums[i] - minimums[i])
   ```
   - `range(feature_num)`ï¼šç”Ÿæˆä» 0 åˆ° `feature_num - 1` çš„æ•´æ•°åºåˆ—ã€‚è¿™é‡Œçš„ `feature_num` åº”è¯¥æ˜¯æ•°æ®é›†çš„ç‰¹å¾æ•°ï¼Œå³åˆ—æ•°ã€‚
   - `data[:, i]`ï¼šé€‰å–æ•°æ®é›† `data` çš„ç¬¬ `i` åˆ—ã€‚`:` è¡¨ç¤ºæ‰€æœ‰è¡Œï¼Œ`i` è¡¨ç¤ºç¬¬ `i` åˆ—ã€‚æ¯”å¦‚ï¼Œ`data[:, 0]` æ˜¯æ•°æ®é›†çš„ç¬¬ä¸€åˆ—ã€‚
   - `(data[:, i] - avgs[i]) / (maximums[i] - minimums[i])`ï¼šå¯¹ç¬¬ `i` åˆ—çš„æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚å½’ä¸€åŒ–å…¬å¼æ˜¯ï¼š
	$$
	 \text{normalized\_value} = \frac{\text{original\_value} - \text{mean}}{\text{max} - \text{min}}
	$$
	 å…¶ä¸­ï¼Œ`original_value` æ˜¯æ•°æ®é›†ä¸­æŸä¸ªç‰¹å¾çš„åŸå§‹å€¼ï¼Œ`mean` æ˜¯è¯¥ç‰¹å¾çš„å¹³å‡å€¼ï¼Œ`max` æ˜¯è¯¥ç‰¹å¾çš„æœ€å¤§å€¼ï¼Œ`min` æ˜¯è¯¥ç‰¹å¾çš„æœ€å°å€¼ã€‚



### ç¬¬äºŒæ­¥ï¼šæ¨¡å‹è®¾è®¡
æ¨¡å‹è®¾è®¡æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹å…³é”®è¦ç´ ä¹‹ä¸€ï¼Œä¹Ÿç§°ä¸ºç½‘ç»œç»“æ„è®¾è®¡ï¼Œç›¸å½“äºæ¨¡å‹çš„å‡è®¾ç©ºé—´ï¼Œå³å®ç°æ¨¡å‹â€œå‰å‘è®¡ç®—â€ï¼ˆä»è¾“å…¥åˆ°è¾“å‡ºï¼‰çš„è¿‡ç¨‹ã€‚

å¦‚æœå°†è¾“å…¥**ç‰¹å¾**å’Œè¾“å‡º**é¢„æµ‹å€¼**å‡ä»¥å‘é‡è¡¨ç¤ºï¼Œè¾“å…¥ç‰¹å¾ğ‘¥æœ‰13ä¸ªå‘é‡ï¼Œğ‘¦æœ‰1ä¸ªå‘é‡ï¼Œé‚£ä¹ˆå‚æ•°æƒé‡çš„å½¢çŠ¶æ˜¯13Ã—1ã€‚å‡è®¾æˆ‘ä»¬ä»¥å¦‚ä¸‹ä»»æ„æ•°å­—èµ‹å€¼å‚æ•°åšåˆå§‹åŒ–ï¼š
$$
ğ‘¤=[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,âˆ’0.1,âˆ’0.2,âˆ’0.3,âˆ’0.4,0.0]
$$
```python 
w = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, -0.1, -0.2, -0.3, -0.4, 0.0] 
w = np.array(w).reshape([13, 1])
```


>ç®€å•çº¿æ€§å›å½’æ¨¡å‹çš„å‰å‘è®¡ç®—è¿‡ç¨‹

```python
class Network(object):
    def __init__(self, num_of_weights):
        # éšæœºäº§ç”Ÿwçš„åˆå§‹å€¼
        # ä¸ºäº†ä¿æŒç¨‹åºæ¯æ¬¡è¿è¡Œç»“æœçš„ä¸€è‡´æ€§ï¼Œ
        # æ­¤å¤„è®¾ç½®å›ºå®šçš„éšæœºæ•°ç§å­
        np.random.seed(0)
        self.w = np.random.randn(num_of_weights, 1)
        self.b = 0.
        
    def forward(self, x):
        z = np.dot(x, self.w) + self.b
        return z
    
net = Network(num_of_weights = 13)
x1 = x[0]
y1 = y[0]
z = net.forward(x1)
print(z)
```

1. ç±»çš„å®šä¹‰
    `Network` ç±»ç”¨äºå®šä¹‰ä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’æ¨¡å‹ã€‚
	  - `__init__` æ–¹æ³•åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°ã€‚
	  - `num_of_weights` è¡¨ç¤ºç‰¹å¾çš„æ•°é‡ï¼ˆå³æƒé‡çš„æ•°é‡ï¼‰ã€‚
	  - `np.random.seed(0)` ç”¨äºè®¾ç½®éšæœºç§å­ï¼Œä»¥ä¿è¯æ¯æ¬¡è¿è¡Œæ—¶ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒï¼Œä»è€Œä½¿å¾—ç¨‹åºå…·æœ‰å¯é‡å¤æ€§ã€‚
	  - `self.w` åˆå§‹åŒ–ä¸ºä¸€ä¸ªå½¢çŠ¶ä¸º `(num_of_weights, 1)` çš„éšæœºæƒé‡å‘é‡ã€‚
	  - `self.b` åˆå§‹åŒ–ä¸º0ï¼Œè¡¨ç¤ºåç½®é¡¹ã€‚

 2. å‰å‘è®¡ç®—æ–¹æ³•
	  - `forward` æ–¹æ³•å®ç°å‰å‘è®¡ç®—è¿‡ç¨‹ã€‚
	  - `x` æ˜¯è¾“å…¥ç‰¹å¾å‘é‡ã€‚
	  - `np.dot(x, self.w)` è®¡ç®—è¾“å…¥ç‰¹å¾ä¸æƒé‡çš„ç‚¹ç§¯ã€‚
	  - `+ self.b` åŠ ä¸Šåç½®é¡¹ã€‚
	  - è¿”å›å€¼ `z` æ˜¯æ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚

3. åˆ›å»ºæ¨¡å‹å®ä¾‹å¹¶è¿›è¡Œå‰å‘è®¡ç®—
	- `net = Network(num_of_weights = 13)` åˆ›å»ºä¸€ä¸ª `Network` ç±»çš„å®ä¾‹ï¼Œå…¶ä¸­ `num_of_weights` è®¾ç½®ä¸º13ï¼ˆå‡è®¾æ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹çš„æ•°æ®é›†æœ‰13ä¸ªç‰¹å¾ï¼‰ã€‚
	- `x1 = x[0]` å–æ•°æ®é›†çš„ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ã€‚
	- `y1 = y[0]` å–æ•°æ®é›†çš„ç¬¬ä¸€ä¸ªæ ·æœ¬çš„ç›®æ ‡å€¼ï¼ˆå®é™…æˆ¿ä»·ï¼‰ã€‚
	- `z = net.forward(x1)` è®¡ç®—ç¬¬ä¸€ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ `z`ã€‚
	- `print(z)` æ‰“å°é¢„æµ‹å€¼ã€‚


### ç¬¬ä¸‰æ­¥ï¼šè®­ç»ƒé…ç½®
æ¨¡å‹è®¾è®¡å®Œæˆåï¼Œéœ€è¦é€šè¿‡è®­ç»ƒé…ç½®å¯»æ‰¾æ¨¡å‹çš„æœ€ä¼˜å€¼ï¼Œå³é€šè¿‡æŸå¤±å‡½æ•°æ¥è¡¡é‡æ¨¡å‹çš„å¥½åã€‚è®­ç»ƒé…ç½®ä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹å…³é”®è¦ç´ ä¹‹ä¸€ã€‚

é€šè¿‡æ¨¡å‹è®¡ç®—ğ‘¥è¡¨ç¤ºçš„å½±å“å› ç´ æ‰€å¯¹åº”çš„æˆ¿ä»·åº”è¯¥æ˜¯ğ‘§, ä½†å®é™…æ•°æ®å‘Šè¯‰æˆ‘ä»¬æˆ¿ä»·æ˜¯ğ‘¦ã€‚è¿™æ—¶æˆ‘ä»¬éœ€è¦æœ‰æŸç§æŒ‡æ ‡æ¥è¡¡é‡**é¢„æµ‹å€¼ğ‘§**è·Ÿ**çœŸå®å€¼ğ‘¦**ä¹‹é—´çš„å·®è·ã€‚å¯¹äºå›å½’é—®é¢˜ï¼Œæœ€å¸¸é‡‡ç”¨çš„è¡¡é‡æ–¹æ³•æ˜¯ä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºè¯„ä»·æ¨¡å‹å¥½åçš„æŒ‡æ ‡ï¼Œå…¬å¼ä¸º
$$
Loss=(yâˆ’z)^2
$$
ä¸Šå¼ä¸­çš„ğ¿ğ‘œğ‘ ğ‘ é€šå¸¸ä¹Ÿè¢«ç§°ä½œæŸå¤±å‡½æ•°ï¼Œå®ƒæ˜¯è¡¡é‡æ¨¡å‹å¥½åçš„æŒ‡æ ‡ã€‚åœ¨å›å½’é—®é¢˜ä¸­å¸¸ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œè€Œåœ¨åˆ†ç±»é—®é¢˜ä¸­å¸¸ç”¨é‡‡ç”¨äº¤å‰ç†µï¼ˆCross-Entropyï¼‰ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œåœ¨åç»­çš„ç« èŠ‚ä¸­ä¼šæ›´è¯¦ç»†çš„ä»‹ç»ã€‚å¯¹å…¶ä¸­ä»»æ„ä¸€ä¸ªæ ·æœ¬è®¡ç®—æŸå¤±å‡½æ•°å€¼çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š
```python
Loss = (y1 - z)*(y1 - z)
print(Loss)
```


å› ä¸ºè®¡ç®—æŸå¤±å‡½æ•°æ—¶éœ€è¦æŠŠæ¯ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°å€¼éƒ½è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å•ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°è¿›è¡Œæ±‚å’Œï¼Œå¹¶é™¤ä»¥æ ·æœ¬æ€»æ•°ğ‘Nã€‚å…¬å¼ä¸º



åœ¨Networkç±»ä¸‹é¢æ·»åŠ æŸå¤±å‡½æ•°çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š

```python
class Network(object):
    def __init__(self, num_of_weights):
        # éšæœºäº§ç”Ÿwçš„åˆå§‹å€¼
        # ä¸ºäº†ä¿æŒç¨‹åºæ¯æ¬¡è¿è¡Œç»“æœçš„ä¸€è‡´æ€§ï¼Œæ­¤å¤„è®¾ç½®å›ºå®šçš„éšæœºæ•°ç§å­
        np.random.seed(0)
        self.w = np.random.randn(num_of_weights, 1)
        self.b = 0.
        
    def forward(self, x):
        z = np.dot(x, self.w) + self.b
        return z
    
    def loss(self, z, y):
        error = z - y
        cost = error * error
        cost = np.mean(cost)
        return cost

net = Network(13)
# æ­¤å¤„å¯ä»¥ä¸€æ¬¡æ€§è®¡ç®—å¤šä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼å’ŒæŸå¤±å‡½æ•°
x1 = x[0:3]
y1 = y[0:3]
z = net.forward(x1)
print('predict: ', z)
loss = net.loss(z, y1)
print('loss:', loss)
```

### ç¬¬å››æ­¥ï¼šè®­ç»ƒè¿‡ç¨‹

ä¸Šè¿°è®¡ç®—æè¿°äº†å¦‚ä½•æ„å»ºç¥ç»ç½‘ç»œï¼Œé€šè¿‡ç¥ç»ç½‘ç»œå®Œæˆé¢„æµ‹å€¼å’ŒæŸå¤±å‡½æ•°çš„è®¡ç®—ã€‚æ¥ä¸‹æ¥ä»‹ç»å¦‚ä½•æ±‚è§£å‚æ•° $w$  å’Œ $b$  çš„æ•°å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿç§°ä¸ºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ã€‚è®­ç»ƒè¿‡ç¨‹æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å…³é”®è¦ç´ ä¹‹ä¸€ï¼Œå…¶ç›®æ ‡æ˜¯ä½¿å®šä¹‰çš„æŸå¤±å‡½æ•°å°½å¯èƒ½çš„å°ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰¾åˆ°ä¸€ä¸ªå‚æ•°è§£ $w$ å’Œ $b$ ï¼Œä½¿å¾—æŸå¤±å‡½æ•°å–å¾—æå°å€¼ã€‚

é¦–å…ˆåšä¸€ä¸ªå°æµ‹è¯•ï¼šå¦‚å›¾5æ‰€ç¤ºï¼ŒåŸºäºå¾®ç§¯åˆ†çŸ¥è¯†ï¼Œæ±‚ä¸€æ¡æ›²çº¿åœ¨æŸä¸ªç‚¹çš„æ–œç‡ç­‰äºå‡½æ•°åœ¨è¯¥ç‚¹çš„å¯¼æ•°å€¼ã€‚é‚£ä¹ˆå¤§å®¶æ€è€ƒä¸‹ï¼Œå½“å¤„äºæ›²çº¿çš„æå€¼ç‚¹æ—¶ï¼Œè¯¥ç‚¹çš„æ–œç‡æ˜¯å¤šå°‘ï¼Ÿ
![[Pasted image 20240725143553.png]]
ä¸Šå›¾æ˜¯æ›²çº¿æ–œç‡ç­‰äºå¯¼æ•°å€¼çš„ç¤ºæ„å›¾ã€‚è¿™ä¸ªé—®é¢˜å¹¶ä¸éš¾å›ç­”ï¼Œå¤„äºæ›²çº¿æå€¼ç‚¹çš„æ–œç‡ä¸º0ï¼Œå³å‡½æ•°åœ¨æå€¼ç‚¹çš„å¯¼æ•°ä¸º0ã€‚é‚£ä¹ˆï¼Œè®©æŸå¤±å‡½æ•°å€¼$L$å–å¾—æå°å€¼çš„ \( w \) å’Œ \( b \) åº”è¯¥æ˜¯ä¸‹è¿°æ–¹ç¨‹ç»„çš„è§£ï¼š
$$
\frac{\partial L}{\partial w} = 0
$$
$$
\frac{\partial L}{\partial b} = 0
$$
å°†æ ·æœ¬æ•°æ® $( x, y)$ å¸¦å…¥ä¸Šé¢çš„æ–¹ç¨‹ç»„ä¸­å³å¯æ±‚è§£å‡º $w$ å’Œ $b$ çš„å€¼ï¼Œä½†è¿™äº›æ–¹æ³•åªå¯¹çº¿æ€§å›å½’è¿™æ ·çš„ç®€å•ä»»åŠ¡æœ‰æ•ˆã€‚å¦‚æœæ¨¡å‹ä¸­å«æœ‰éçº¿æ€§å˜æ¢ï¼Œæˆ–è€…æŸå¤±å‡½æ•°ä¸æ˜¯å‡æ–¹å·®è¿™æ ·çš„ç®€å•å½¢å¼ï¼Œåˆ™å¾ˆéš¾é€šè¿‡ä¸Šè¿°æ–¹ç¨‹ç»„æ±‚è§£ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬å°†å¼•å…¥æ›´åŠ æ™®é€‚çš„æ•°å€¼æ±‚è§£æ–¹æ³•ï¼šæ¢¯åº¦ä¸‹é™æ³•ã€‚

>æ¢¯åº¦ä¸‹é™æ³•é€šè¿‡ä¸æ–­è°ƒæ•´å‚æ•° $w$ å’Œ $b$ï¼Œä½¿æŸå¤±å‡½æ•°é€æ­¥å‡å°‘ï¼Œæœ€ç»ˆæ‰¾åˆ°æŸå¤±å‡½æ•°çš„æå°å€¼ã€‚

















```python
# ç”»å›¾çœ‹ç‰¹å¾é—´çš„å…³ç³»,ä¸»è¦æ˜¯å˜é‡ä¸¤ä¸¤ä¹‹é—´çš„å…³ç³»ï¼ˆçº¿æ€§æˆ–éçº¿æ€§ï¼Œæœ‰æ— æ˜æ˜¾è¾ƒä¸ºç›¸å…³å…³ç³»ï¼‰
features_np = np.array([x[:13] for x in housing_data], np.float32)
labels_np = np.array([x[-1] for x in housing_data], np.float32)
# data_np = np.c_[features_np, labels_np]
df = pd.DataFrame(housing_data, columns=feature_names)
matplotlib.use("TkAgg")
%matplotlib inline
sns.pairplot(
    df.dropna(),
    y_vars=feature_names[-1],
    x_vars=feature_names[::-1],
    diag_kind="kde",
)
plt.show()
```


# å®æˆ˜ï¼šæ‰‹å†™æ•°å­—è¯†åˆ«